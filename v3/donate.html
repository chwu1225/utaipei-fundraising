<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç·šä¸Šææ¬¾ | è‡ºåŒ—å¸‚ç«‹å¤§å­¸å‹Ÿæ¬¾å¹³å°</title>
    <meta name="description" content="æ”¯æŒè‡ºåŒ—å¸‚ç«‹å¤§å­¸ï¼Œæ‚¨çš„æ¯ä¸€ä»½ææ¬¾éƒ½å°‡åŒ–ç‚ºå­¸ç”Ÿè¿½å¤¢çš„åŠ›é‡ã€‚å®‰å…¨åŠ å¯†ã€å¯æŠµç¨…ææ¬¾ã€‚">
    <meta property="og:title" content="ç·šä¸Šææ¬¾ | è‡ºåŒ—å¸‚ç«‹å¤§å­¸å‹Ÿæ¬¾å¹³å°">
    <meta property="og:description" content="é»äº®æœªä¾†ï¼Œè‚²æ‰èˆˆé‚¦ã€‚ç«‹å³ææ¬¾æ”¯æŒæ•™è‚²ç™¼å±•ã€‚">
    <link rel="canonical" href="https://utaipei-fundraising.zeabur.app/v3/donate.html">
    <link rel="icon" type="image/jpeg" href="images/logo.jpg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark': '#0a1628',
                        'primary': '#1e3a5f',
                        'secondary': '#162d4a',
                        'card': '#1a3352',
                        'gold': '#d4a84b',
                        'gold-light': '#e8c87a',
                    },
                    fontFamily: {
                        'sans': ['Noto Sans TC', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body class="bg-dark text-white font-sans">
    <div id="app" class="starry-bg min-h-screen">
        <!-- Demo Ribbon -->
        <div class="demo-ribbon"><span>ğŸ“‹ è¨ˆä¸­å±•ç¤ºç‰ˆ</span></div>

        <!-- Shooting Stars -->
        <div class="shooting-stars">
            <div class="shooting-star"></div>
            <div class="shooting-star"></div>
            <div class="shooting-star"></div>
        </div>

        <!-- Header -->
        <header class="header-glass fixed top-0 left-0 right-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16 md:h-20">
                    <a href="index.html" class="flex items-center gap-3">
                        <img :src="schoolInfo.logo" alt="æ ¡å¾½" class="h-10 w-10 rounded-full object-cover border-2 border-gold/30">
                        <div class="hidden sm:block">
                            <div class="text-lg font-bold text-gold">{{ schoolInfo.name }}</div>
                            <div class="text-xs text-gray-400">å‹Ÿæ¬¾å¹³å°</div>
                        </div>
                    </a>
                    <nav class="hidden md:flex items-center gap-8">
                        <a href="index.html" class="nav-link">é¦–é </a>
                        <a href="projects.html" class="nav-link">å°ˆæ¡ˆç¸½è¦½</a>
                        <a href="about.html" class="nav-link">é—œæ–¼æˆ‘å€‘</a>
                        <a href="honor.html" class="nav-link">èŠ³åéŒ„</a>
                    </nav>
                    <a href="donate.html" class="btn-gold ripple text-sm md:text-base active">ç«‹å³ææ¬¾</a>
                </div>
            </div>
        </header>

        <!-- Page Header -->
        <section class="pt-28 pb-8 relative z-10">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">ç·šä¸Šææ¬¾</h1>
                <p class="text-gray-400 max-w-2xl mx-auto mb-6">
                    æ‚¨çš„æ¯ä¸€ä»½æ”¯æŒï¼Œéƒ½æ˜¯ç…§äº®å­¸å­å¤¢æƒ³çš„æ˜ç‡ˆ
                </p>
                <!-- Trust Badges -->
                <div class="flex justify-center gap-4 flex-wrap">
                    <span class="trust-badge security">
                        ğŸ”’ SSL å®‰å…¨åŠ å¯†
                    </span>
                    <span class="trust-badge">
                        âœ“ å¯æŠµç¨…ææ¬¾
                    </span>
                    <span class="trust-badge">
                        ğŸ“„ é–‹ç«‹æ­£å¼æ”¶æ“š
                    </span>
                </div>
            </div>
        </section>

        <!-- Step Indicator -->
        <section class="py-6 relative z-10">
            <div class="max-w-4xl mx-auto px-4">
                <div class="step-indicator">
                    <div class="step-item">
                        <div :class="['step-circle', { 'active': currentStep === 1, 'completed': currentStep > 1 }]">
                            <span v-if="currentStep <= 1">1</span>
                        </div>
                        <span class="hidden sm:block ml-2 text-sm" :class="currentStep >= 1 ? 'text-gold' : 'text-gray-500'">é¸æ“‡æ–¹æ¡ˆ</span>
                    </div>
                    <div :class="['step-line', { 'active': currentStep > 1 }]"></div>
                    <div class="step-item">
                        <div :class="['step-circle', { 'active': currentStep === 2, 'completed': currentStep > 2 }]">
                            <span v-if="currentStep <= 2">2</span>
                        </div>
                        <span class="hidden sm:block ml-2 text-sm" :class="currentStep >= 2 ? 'text-gold' : 'text-gray-500'">å¡«å¯«è³‡æ–™</span>
                    </div>
                    <div :class="['step-line', { 'active': currentStep > 2 }]"></div>
                    <div class="step-item">
                        <div :class="['step-circle', { 'active': currentStep === 3, 'completed': currentStep > 3 }]">
                            <span v-if="currentStep <= 3">3</span>
                        </div>
                        <span class="hidden sm:block ml-2 text-sm" :class="currentStep >= 3 ? 'text-gold' : 'text-gray-500'">ç¢ºèªææ¬¾</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 1: Select Project & Amount -->
        <section v-show="currentStep === 1" class="py-8 relative z-10">
            <div class="max-w-4xl mx-auto px-4">
                <!-- Project Selection -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ¯</span> é¸æ“‡ææ¬¾å°ˆæ¡ˆ
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div
                            v-for="project in projects"
                            :key="project.id"
                            @click="selectProject(project.id)"
                            :class="['payment-option cursor-pointer', { 'selected': selectedProject === project.id }]"
                        >
                            <div class="payment-icon">{{ project.icon }}</div>
                            <div class="flex-1">
                                <div class="font-medium">{{ project.name }}</div>
                                <div class="text-sm text-gray-400">{{ project.description }}</div>
                                <div class="mt-2">
                                    <div class="progress-bar-container h-1.5">
                                        <div class="progress-bar-fill" :style="{ width: utils.calcProgress(project.raised, project.goal) + '%' }"></div>
                                    </div>
                                    <div class="text-xs text-gray-500 mt-1">
                                        å·²å‹Ÿå¾— {{ utils.calcProgress(project.raised, project.goal) }}%
                                    </div>
                                </div>
                            </div>
                            <div v-if="selectedProject === project.id" class="text-gold text-xl">âœ“</div>
                        </div>
                        <!-- Flexible Donation Option -->
                        <div
                            @click="selectProject('flexible')"
                            :class="['payment-option cursor-pointer', { 'selected': selectedProject === 'flexible' }]"
                        >
                            <div class="payment-icon">ğŸ’</div>
                            <div class="flex-1">
                                <div class="font-medium">ä¸æŒ‡å®šç”¨é€”</div>
                                <div class="text-sm text-gray-400">ç”±å­¸æ ¡çµ±ç±Œé‹ç”¨æ–¼æœ€éœ€è¦çš„é …ç›®</div>
                            </div>
                            <div v-if="selectedProject === 'flexible'" class="text-gold text-xl">âœ“</div>
                        </div>
                    </div>
                </div>

                <!-- Amount Selection -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ’°</span> é¸æ“‡ææ¬¾é‡‘é¡
                    </h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                        <button
                            v-for="item in donationAmounts"
                            :key="item.amount"
                            @click="selectAmount(item.amount)"
                            :class="['amount-btn text-left', { 'active': selectedAmount === item.amount && !customAmountActive }]"
                        >
                            <div>NT$ {{ utils.formatNumber(item.amount) }}</div>
                            <span class="amount-impact">{{ item.impact }}</span>
                        </button>
                    </div>
                    <!-- Custom Amount -->
                    <div class="form-group">
                        <label class="form-label">è‡ªè¨‚é‡‘é¡</label>
                        <div class="relative">
                            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">NT$</span>
                            <input
                                type="number"
                                v-model="customAmount"
                                @focus="customAmountActive = true"
                                @input="onCustomAmountInput"
                                class="form-input pl-16"
                                placeholder="è«‹è¼¸å…¥é‡‘é¡"
                                min="100"
                            >
                        </div>
                        <p v-if="customAmountError" class="text-red-400 text-sm mt-2">{{ customAmountError }}</p>
                        <p class="text-gray-500 text-sm mt-2">æœ€ä½ææ¬¾é‡‘é¡ç‚º NT$ 100</p>
                    </div>
                </div>

                <!-- Donation Type -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ”„</span> ææ¬¾æ–¹å¼
                    </h2>
                    <div class="flex gap-4">
                        <button
                            @click="donationType = 'single'"
                            :class="['flex-1 py-4 rounded-xl border-2 transition-all', donationType === 'single' ? 'border-gold bg-gold/10 text-gold' : 'border-gray-600 text-gray-400']"
                        >
                            <div class="text-2xl mb-2">ğŸ’µ</div>
                            <div class="font-medium">å–®æ¬¡ææ¬¾</div>
                        </button>
                        <button
                            @click="donationType = 'monthly'"
                            :class="['flex-1 py-4 rounded-xl border-2 transition-all', donationType === 'monthly' ? 'border-gold bg-gold/10 text-gold' : 'border-gray-600 text-gray-400']"
                        >
                            <div class="text-2xl mb-2">ğŸ“…</div>
                            <div class="font-medium">æ¯æœˆå®šæœŸææ¬¾</div>
                        </button>
                    </div>
                    <p v-if="donationType === 'monthly'" class="text-gray-400 text-sm mt-4">
                        å®šæœŸææ¬¾å°‡æ–¼æ¯æœˆ 15 æ—¥è‡ªå‹•æ‰£æ¬¾ï¼Œæ‚¨å¯éš¨æ™‚å–æ¶ˆã€‚
                    </p>
                </div>

                <!-- Step 1 Navigation -->
                <div class="flex justify-end">
                    <button
                        @click="nextStep"
                        :disabled="!canProceedStep1"
                        :class="['btn-gold ripple px-8 py-4 text-lg', { 'opacity-50 cursor-not-allowed': !canProceedStep1 }]"
                    >
                        ä¸‹ä¸€æ­¥ï¼šå¡«å¯«è³‡æ–™ â†’
                    </button>
                </div>
            </div>
        </section>

        <!-- Step 2: Donor Information -->
        <section v-show="currentStep === 2" class="py-8 relative z-10">
            <div class="max-w-4xl mx-auto px-4">
                <!-- Summary Card -->
                <div class="glass-card p-6 mb-8 border-gold/30">
                    <div class="flex items-center justify-between flex-wrap gap-4">
                        <div>
                            <span class="text-gray-400">ææ¬¾å°ˆæ¡ˆï¼š</span>
                            <span class="text-gold font-medium">{{ getProjectName() }}</span>
                        </div>
                        <div>
                            <span class="text-gray-400">ææ¬¾é‡‘é¡ï¼š</span>
                            <span class="text-gold font-bold text-xl">{{ utils.formatCurrency(getFinalAmount()) }}</span>
                            <span v-if="donationType === 'monthly'" class="text-gray-400 text-sm"> / æœˆ</span>
                        </div>
                    </div>
                </div>

                <!-- Personal Information -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ‘¤</span> ææ¬¾äººè³‡è¨Š
                    </h2>

                    <!-- Donor Type -->
                    <div class="flex gap-4 mb-6">
                        <button
                            @click="donorType = 'personal'"
                            :class="['flex-1 py-3 rounded-lg border-2 transition-all', donorType === 'personal' ? 'border-gold bg-gold/10 text-gold' : 'border-gray-600 text-gray-400']"
                        >
                            å€‹äººææ¬¾
                        </button>
                        <button
                            @click="donorType = 'corporate'"
                            :class="['flex-1 py-3 rounded-lg border-2 transition-all', donorType === 'corporate' ? 'border-gold bg-gold/10 text-gold' : 'border-gray-600 text-gray-400']"
                        >
                            ä¼æ¥­ / åœ˜é«”ææ¬¾
                        </button>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Name -->
                        <div class="form-group relative">
                            <label class="form-label">
                                {{ donorType === 'corporate' ? 'å…¬å¸ / åœ˜é«”åç¨±' : 'å§“å' }}
                                <span class="text-red-400">*</span>
                            </label>
                            <input
                                type="text"
                                v-model="form.name"
                                @blur="validateField('name')"
                                :class="['form-input', formErrors.name ? 'invalid' : (form.name && !formErrors.name ? 'valid' : '')]"
                                :placeholder="donorType === 'corporate' ? 'è«‹è¼¸å…¥å…¬å¸æˆ–åœ˜é«”å…¨å' : 'è«‹è¼¸å…¥çœŸå¯¦å§“å'"
                            >
                            <p v-if="formErrors.name" class="text-red-400 text-sm mt-1">{{ formErrors.name }}</p>
                        </div>

                        <!-- Email -->
                        <div class="form-group relative">
                            <label class="form-label">
                                é›»å­éƒµä»¶
                                <span class="text-red-400">*</span>
                            </label>
                            <input
                                type="email"
                                v-model="form.email"
                                @blur="validateField('email')"
                                :class="['form-input', formErrors.email ? 'invalid' : (form.email && !formErrors.email ? 'valid' : '')]"
                                placeholder="example@email.com"
                            >
                            <p v-if="formErrors.email" class="text-red-400 text-sm mt-1">{{ formErrors.email }}</p>
                        </div>

                        <!-- Phone -->
                        <div class="form-group relative">
                            <label class="form-label">
                                è¯çµ¡é›»è©±
                                <span class="text-red-400">*</span>
                            </label>
                            <input
                                type="tel"
                                v-model="form.phone"
                                @blur="validateField('phone')"
                                :class="['form-input', formErrors.phone ? 'invalid' : (form.phone && !formErrors.phone ? 'valid' : '')]"
                                placeholder="0912-345-678"
                            >
                            <p v-if="formErrors.phone" class="text-red-400 text-sm mt-1">{{ formErrors.phone }}</p>
                        </div>

                        <!-- ID Number (for tax receipt) -->
                        <div class="form-group relative">
                            <label class="form-label">
                                {{ donorType === 'corporate' ? 'çµ±ä¸€ç·¨è™Ÿ' : 'èº«åˆ†è­‰å­—è™Ÿ' }}
                                <span class="text-gray-500 text-xs">ï¼ˆæ”¶æ“šé–‹ç«‹ç”¨ï¼‰</span>
                            </label>
                            <input
                                type="text"
                                v-model="form.idNumber"
                                @blur="validateField('idNumber')"
                                :class="['form-input', formErrors.idNumber ? 'invalid' : (form.idNumber && !formErrors.idNumber ? 'valid' : '')]"
                                :placeholder="donorType === 'corporate' ? 'è«‹è¼¸å…¥ 8 ç¢¼çµ±ä¸€ç·¨è™Ÿ' : 'è«‹è¼¸å…¥èº«åˆ†è­‰å­—è™Ÿ'"
                            >
                            <p v-if="formErrors.idNumber" class="text-red-400 text-sm mt-1">{{ formErrors.idNumber }}</p>
                        </div>

                        <!-- Address -->
                        <div class="form-group md:col-span-2 relative">
                            <label class="form-label">
                                æ”¶æ“šå¯„é€åœ°å€
                                <span class="text-gray-500 text-xs">ï¼ˆéƒµå¯„å¯¦é«”æ”¶æ“šæ™‚ä½¿ç”¨ï¼‰</span>
                            </label>
                            <input
                                type="text"
                                v-model="form.address"
                                class="form-input"
                                placeholder="è«‹è¼¸å…¥å®Œæ•´åœ°å€"
                            >
                        </div>
                    </div>

                    <!-- Anonymous Option -->
                    <div class="mt-6">
                        <label class="flex items-center gap-3 cursor-pointer">
                            <input
                                type="checkbox"
                                v-model="form.isAnonymous"
                                class="w-5 h-5 rounded border-gray-600 bg-card text-gold focus:ring-gold"
                            >
                            <span class="text-gray-300">æˆ‘å¸Œæœ›åŒ¿åææ¬¾ï¼ˆèŠ³åéŒ„é¡¯ç¤ºç‚ºã€Œå–„å¿ƒäººå£«ã€ï¼‰</span>
                        </label>
                    </div>
                </div>

                <!-- Receipt Options -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ“„</span> ææ¬¾æ”¶æ“š
                    </h2>
                    <div class="space-y-4">
                        <label class="flex items-start gap-3 cursor-pointer p-4 rounded-xl border border-gray-700 hover:border-gold/50 transition-all"
                               :class="{ 'border-gold bg-gold/5': receiptType === 'email' }">
                            <input
                                type="radio"
                                v-model="receiptType"
                                value="email"
                                class="mt-1 w-5 h-5 text-gold focus:ring-gold"
                            >
                            <div>
                                <div class="font-medium">é›»å­æ”¶æ“š</div>
                                <div class="text-sm text-gray-400">å¯„é€è‡³æ‚¨çš„é›»å­éƒµä»¶ä¿¡ç®±ï¼ˆç’°ä¿å¿«é€Ÿï¼‰</div>
                            </div>
                        </label>
                        <label class="flex items-start gap-3 cursor-pointer p-4 rounded-xl border border-gray-700 hover:border-gold/50 transition-all"
                               :class="{ 'border-gold bg-gold/5': receiptType === 'mail' }">
                            <input
                                type="radio"
                                v-model="receiptType"
                                value="mail"
                                class="mt-1 w-5 h-5 text-gold focus:ring-gold"
                            >
                            <div>
                                <div class="font-medium">ç´™æœ¬æ”¶æ“š</div>
                                <div class="text-sm text-gray-400">éƒµå¯„è‡³æ‚¨å¡«å¯«çš„åœ°å€ï¼ˆç´„ 7-14 å€‹å·¥ä½œå¤©ï¼‰</div>
                            </div>
                        </label>
                        <label class="flex items-start gap-3 cursor-pointer p-4 rounded-xl border border-gray-700 hover:border-gold/50 transition-all"
                               :class="{ 'border-gold bg-gold/5': receiptType === 'yearly' }">
                            <input
                                type="radio"
                                v-model="receiptType"
                                value="yearly"
                                class="mt-1 w-5 h-5 text-gold focus:ring-gold"
                            >
                            <div>
                                <div class="font-medium">å¹´åº¦å½™ç¸½æ”¶æ“š</div>
                                <div class="text-sm text-gray-400">æ–¼éš”å¹´ä¸€æœˆçµ±ä¸€å¯„ç™¼å…¨å¹´åº¦ææ¬¾æ”¶æ“š</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Payment Method -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ’³</span> ä»˜æ¬¾æ–¹å¼
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div
                            v-for="method in paymentMethods"
                            :key="method.id"
                            @click="selectedPayment = method.id"
                            :class="['payment-option cursor-pointer', { 'selected': selectedPayment === method.id }]"
                        >
                            <div class="payment-icon">{{ method.icon }}</div>
                            <div class="flex-1">
                                <div class="font-medium">{{ method.name }}</div>
                                <div class="text-sm text-gray-400">{{ method.description }}</div>
                            </div>
                            <div v-if="selectedPayment === method.id" class="text-gold text-xl">âœ“</div>
                        </div>
                    </div>
                </div>

                <!-- Step 2 Navigation -->
                <div class="flex justify-between gap-4">
                    <button
                        @click="prevStep"
                        class="btn-outline px-8 py-4"
                    >
                        â† ä¸Šä¸€æ­¥
                    </button>
                    <button
                        @click="nextStep"
                        :disabled="!canProceedStep2"
                        :class="['btn-gold ripple px-8 py-4 text-lg', { 'opacity-50 cursor-not-allowed': !canProceedStep2 }]"
                    >
                        ä¸‹ä¸€æ­¥ï¼šç¢ºèªææ¬¾ â†’
                    </button>
                </div>
            </div>
        </section>

        <!-- Step 3: Confirmation -->
        <section v-show="currentStep === 3" class="py-8 relative z-10">
            <div class="max-w-4xl mx-auto px-4">
                <!-- Confirmation Summary -->
                <div class="glass-card p-6 md:p-8 mb-8">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <span class="text-2xl">ğŸ“‹</span> ææ¬¾è³‡è¨Šç¢ºèª
                    </h2>

                    <div class="space-y-6">
                        <!-- Donation Info -->
                        <div class="bg-card/50 rounded-xl p-6">
                            <h3 class="font-medium text-gold mb-4">ææ¬¾å…§å®¹</h3>
                            <div class="grid md:grid-cols-2 gap-4 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">ææ¬¾å°ˆæ¡ˆ</span>
                                    <span>{{ getProjectName() }}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">ææ¬¾é‡‘é¡</span>
                                    <span class="text-gold font-bold">{{ utils.formatCurrency(getFinalAmount()) }}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">ææ¬¾æ–¹å¼</span>
                                    <span>{{ donationType === 'monthly' ? 'æ¯æœˆå®šæœŸææ¬¾' : 'å–®æ¬¡ææ¬¾' }}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">ä»˜æ¬¾æ–¹å¼</span>
                                    <span>{{ getPaymentName() }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Donor Info -->
                        <div class="bg-card/50 rounded-xl p-6">
                            <h3 class="font-medium text-gold mb-4">ææ¬¾äººè³‡è¨Š</h3>
                            <div class="grid md:grid-cols-2 gap-4 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">{{ donorType === 'corporate' ? 'å…¬å¸åç¨±' : 'å§“å' }}</span>
                                    <span>{{ form.isAnonymous ? 'åŒ¿åææ¬¾' : form.name }}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">é›»å­éƒµä»¶</span>
                                    <span>{{ form.email }}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">è¯çµ¡é›»è©±</span>
                                    <span>{{ form.phone }}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">æ”¶æ“šå½¢å¼</span>
                                    <span>{{ getReceiptTypeName() }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Message (Optional) -->
                        <div class="form-group">
                            <label class="form-label">ç•™è¨€é¼“å‹µï¼ˆé¸å¡«ï¼‰</label>
                            <textarea
                                v-model="form.message"
                                class="form-input resize-none"
                                rows="3"
                                placeholder="æ‚¨çš„é¼“å‹µå°‡æˆç‚ºå­¸ç”Ÿå€‘å‰é€²çš„å‹•åŠ›..."
                            ></textarea>
                        </div>
                    </div>
                </div>

                <!-- Terms Agreement -->
                <div class="glass-card p-6 mb-8">
                    <label class="flex items-start gap-3 cursor-pointer">
                        <input
                            type="checkbox"
                            v-model="agreeTerms"
                            class="mt-1 w-5 h-5 rounded border-gray-600 bg-card text-gold focus:ring-gold"
                        >
                        <span class="text-gray-300 text-sm">
                            æˆ‘å·²é–±è®€ä¸¦åŒæ„
                            <a href="#" class="text-gold hover:underline">ææ¬¾é ˆçŸ¥</a>
                            åŠ
                            <a href="#" class="text-gold hover:underline">éš±ç§æ¬Šæ”¿ç­–</a>
                            ï¼Œä¸¦ç¢ºèªä»¥ä¸Šè³‡è¨Šæ­£ç¢ºç„¡èª¤ã€‚
                        </span>
                    </label>
                </div>

                <!-- Final Amount Display -->
                <div class="glass-card p-6 mb-8 border-2 border-gold/50 text-center">
                    <div class="text-gray-400 mb-2">æ‚¨å³å°‡ææ¬¾</div>
                    <div class="text-4xl md:text-5xl font-bold text-gold mb-2">
                        {{ utils.formatCurrency(getFinalAmount()) }}
                    </div>
                    <div v-if="donationType === 'monthly'" class="text-gray-400">æ¯æœˆå®šæœŸææ¬¾</div>
                    <div class="text-sm text-gray-500 mt-4">
                        ğŸ”’ æ‰€æœ‰äº¤æ˜“çš†ç¶“ SSL åŠ å¯†ä¿è­·
                    </div>
                </div>

                <!-- Step 3 Navigation -->
                <div class="flex justify-between gap-4">
                    <button
                        @click="prevStep"
                        class="btn-outline px-8 py-4"
                    >
                        â† ä¸Šä¸€æ­¥
                    </button>
                    <button
                        @click="submitDonation"
                        :disabled="!agreeTerms || isSubmitting"
                        :class="['btn-gold ripple px-12 py-4 text-lg', { 'opacity-50 cursor-not-allowed': !agreeTerms || isSubmitting }]"
                    >
                        <span v-if="isSubmitting">è™•ç†ä¸­...</span>
                        <span v-else>ç¢ºèªææ¬¾ ğŸ’</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Success Modal -->
        <div v-if="showSuccessModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70">
            <div class="glass-card max-w-md w-full p-8 text-center animate-scale-in">
                <div class="text-6xl mb-4">ğŸ‰</div>
                <h2 class="text-2xl font-bold text-gold mb-4">æ„Ÿè¬æ‚¨çš„ææ¬¾ï¼</h2>
                <p class="text-gray-300 mb-6">
                    æ‚¨çš„æ„›å¿ƒå°‡åŒ–ç‚ºå­¸ç”Ÿå€‘è¿½å¤¢çš„åŠ›é‡ã€‚<br>
                    ææ¬¾ç¢ºèªä¿¡å·²å¯„é€è‡³æ‚¨çš„ä¿¡ç®±ã€‚
                </p>
                <div class="bg-card/50 rounded-xl p-4 mb-6">
                    <div class="text-sm text-gray-400 mb-1">ææ¬¾ç·¨è™Ÿ</div>
                    <div class="text-gold font-mono">{{ donationId }}</div>
                </div>
                <div class="flex flex-col sm:flex-row gap-3">
                    <a href="index.html" class="btn-outline flex-1">è¿”å›é¦–é </a>
                    <button @click="shareDonation" class="btn-gold flex-1 ripple">åˆ†äº«æ„›å¿ƒ</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer relative z-10 mt-16">
            <div class="max-w-7xl mx-auto px-4">
                <div class="grid md:grid-cols-4 gap-8 mb-8">
                    <div class="md:col-span-2">
                        <div class="flex items-center gap-3 mb-4">
                            <img :src="schoolInfo.logo" alt="æ ¡å¾½" class="h-12 w-12 rounded-full object-cover">
                            <div>
                                <div class="text-lg font-bold text-gold">{{ schoolInfo.name }}</div>
                                <div class="text-sm text-gray-400">{{ schoolInfo.nameEn }}</div>
                            </div>
                        </div>
                        <p class="text-gray-400 text-sm mb-4">
                            {{ schoolInfo.contact.address }}<br>
                            é›»è©±ï¼š{{ schoolInfo.contact.phone }}<br>
                            Emailï¼š{{ schoolInfo.contact.email }}
                        </p>
                    </div>
                    <div>
                        <h4 class="font-bold mb-4">å¿«é€Ÿé€£çµ</h4>
                        <nav class="flex flex-col gap-2">
                            <a href="projects.html" class="footer-link">å°ˆæ¡ˆç¸½è¦½</a>
                            <a href="donate.html" class="footer-link">ç·šä¸Šææ¬¾</a>
                            <a href="honor.html" class="footer-link">èŠ³åéŒ„</a>
                            <a href="about.html" class="footer-link">é—œæ–¼æˆ‘å€‘</a>
                        </nav>
                    </div>
                    <div>
                        <h4 class="font-bold mb-4">ææ¬¾é ˆçŸ¥</h4>
                        <nav class="flex flex-col gap-2">
                            <a href="#" class="footer-link">éš±ç§æ¬Šæ”¿ç­–</a>
                            <a href="#" class="footer-link">ææ¬¾é ˆçŸ¥</a>
                            <a href="#" class="footer-link">å¸¸è¦‹å•é¡Œ</a>
                            <a href="#" class="footer-link">è¯çµ¡æˆ‘å€‘</a>
                        </nav>
                    </div>
                </div>
                <div class="border-t border-white/10 pt-6 text-center text-sm text-gray-500">
                    <p>Â© 2025 {{ schoolInfo.name }}. All Rights Reserved.</p>
                    <p class="mt-2">æœ¬ç¶²ç«™ç‚ºå±•ç¤ºç”¨é€”ï¼Œå¯¦éš›ææ¬¾è«‹è‡³å­¸æ ¡å®˜æ–¹ç®¡é“</p>
                </div>
            </div>
        </footer>

        <button class="back-to-top" aria-label="è¿”å›é ‚ç«¯">â†‘</button>
    </div>

    <script src="js/app.js"></script>
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    schoolInfo: window.schoolInfo,
                    projects: window.projectsData,
                    paymentMethods: window.paymentMethods,
                    donationAmounts: window.donationAmounts,
                    utils: window.utils,

                    // Step control
                    currentStep: 1,

                    // Step 1: Donation selection
                    selectedProject: null,
                    selectedAmount: null,
                    customAmount: '',
                    customAmountActive: false,
                    customAmountError: '',
                    donationType: 'single',

                    // Step 2: Donor information
                    donorType: 'personal',
                    form: {
                        name: '',
                        email: '',
                        phone: '',
                        idNumber: '',
                        address: '',
                        isAnonymous: false,
                        message: ''
                    },
                    formErrors: {},
                    receiptType: 'email',
                    selectedPayment: 'credit',

                    // Step 3: Confirmation
                    agreeTerms: false,
                    isSubmitting: false,
                    showSuccessModal: false,
                    donationId: ''
                }
            },
            computed: {
                canProceedStep1() {
                    const amount = this.getFinalAmount();
                    return this.selectedProject && amount >= 100;
                },
                canProceedStep2() {
                    return this.form.name &&
                           this.form.email &&
                           this.form.phone &&
                           !this.formErrors.name &&
                           !this.formErrors.email &&
                           !this.formErrors.phone &&
                           this.selectedPayment;
                }
            },
            methods: {
                selectProject(projectId) {
                    this.selectedProject = projectId;
                },
                selectAmount(amount) {
                    this.selectedAmount = amount;
                    this.customAmount = '';
                    this.customAmountActive = false;
                    this.customAmountError = '';
                },
                onCustomAmountInput() {
                    this.selectedAmount = null;
                    this.customAmountActive = true;
                    const value = parseInt(this.customAmount);
                    if (value && value < 100) {
                        this.customAmountError = 'æœ€ä½ææ¬¾é‡‘é¡ç‚º NT$ 100';
                    } else {
                        this.customAmountError = '';
                    }
                },
                getFinalAmount() {
                    if (this.customAmountActive && this.customAmount) {
                        return parseInt(this.customAmount) || 0;
                    }
                    return this.selectedAmount || 0;
                },
                getProjectName() {
                    if (this.selectedProject === 'flexible') {
                        return 'ä¸æŒ‡å®šç”¨é€”';
                    }
                    const project = this.projects.find(p => p.id === this.selectedProject);
                    return project ? project.name : '';
                },
                getPaymentName() {
                    const method = this.paymentMethods.find(m => m.id === this.selectedPayment);
                    return method ? method.name : '';
                },
                getReceiptTypeName() {
                    const types = {
                        'email': 'é›»å­æ”¶æ“š',
                        'mail': 'ç´™æœ¬æ”¶æ“š',
                        'yearly': 'å¹´åº¦å½™ç¸½æ”¶æ“š'
                    };
                    return types[this.receiptType] || '';
                },
                validateField(field) {
                    const value = this.form[field];

                    if (field === 'name') {
                        if (!value || value.trim().length < 2) {
                            this.formErrors.name = 'è«‹è¼¸å…¥å§“åï¼ˆè‡³å°‘2å€‹å­—ï¼‰';
                        } else {
                            delete this.formErrors.name;
                        }
                    }

                    if (field === 'email') {
                        if (!value) {
                            this.formErrors.email = 'è«‹è¼¸å…¥é›»å­éƒµä»¶';
                        } else if (!this.utils.validateEmail(value)) {
                            this.formErrors.email = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶';
                        } else {
                            delete this.formErrors.email;
                        }
                    }

                    if (field === 'phone') {
                        if (!value) {
                            this.formErrors.phone = 'è«‹è¼¸å…¥è¯çµ¡é›»è©±';
                        } else if (!this.utils.validatePhone(value)) {
                            this.formErrors.phone = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»è©±è™Ÿç¢¼';
                        } else {
                            delete this.formErrors.phone;
                        }
                    }

                    if (field === 'idNumber' && value) {
                        if (this.donorType === 'personal') {
                            if (!this.utils.validateTaiwanId(value)) {
                                this.formErrors.idNumber = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„èº«åˆ†è­‰å­—è™Ÿ';
                            } else {
                                delete this.formErrors.idNumber;
                            }
                        } else {
                            // Simple check for corporate ID (8 digits)
                            if (!/^\d{8}$/.test(value)) {
                                this.formErrors.idNumber = 'è«‹è¼¸å…¥ 8 ç¢¼çµ±ä¸€ç·¨è™Ÿ';
                            } else {
                                delete this.formErrors.idNumber;
                            }
                        }
                    }

                    // Force reactivity
                    this.formErrors = { ...this.formErrors };
                },
                nextStep() {
                    if (this.currentStep === 1 && this.canProceedStep1) {
                        this.currentStep = 2;
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    } else if (this.currentStep === 2 && this.canProceedStep2) {
                        this.currentStep = 3;
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                },
                prevStep() {
                    if (this.currentStep > 1) {
                        this.currentStep--;
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                },
                async submitDonation() {
                    if (!this.agreeTerms || this.isSubmitting) return;

                    this.isSubmitting = true;

                    // Simulate API call
                    await new Promise(resolve => setTimeout(resolve, 2000));

                    // Generate donation ID
                    this.donationId = 'UT' + Date.now().toString().slice(-8) + Math.random().toString(36).slice(-4).toUpperCase();

                    // Save donation preferences
                    if (window.donationPrefs) {
                        window.donationPrefs.save({
                            lastAmount: this.getFinalAmount(),
                            lastProject: this.selectedProject,
                            donorType: this.donorType
                        });
                    }

                    this.isSubmitting = false;
                    this.showSuccessModal = true;

                    if (window.toast) {
                        window.toast.show('ææ¬¾æˆåŠŸï¼æ„Ÿè¬æ‚¨çš„æ„›å¿ƒ', 'success');
                    }
                },
                shareDonation() {
                    const text = `æˆ‘å‰›å‰›ææ¬¾æ”¯æŒäº†${this.getProjectName()}ï¼ä¸€èµ·ä¾†æ”¯æŒè‡ºåŒ—å¸‚ç«‹å¤§å­¸å‹Ÿæ¬¾è¨ˆç•«å§ï¼`;
                    if (window.socialShare) {
                        window.socialShare.facebook(text);
                    }
                },
                initFromUrl() {
                    const params = new URLSearchParams(window.location.search);
                    const projectId = params.get('project');
                    const amount = params.get('amount');

                    if (projectId) {
                        const numId = parseInt(projectId);
                        const project = this.projects.find(p => p.id === numId);
                        if (project) {
                            this.selectedProject = numId;
                        }
                    }

                    if (amount) {
                        const numAmount = parseInt(amount);
                        if (numAmount >= 100) {
                            const preset = this.donationAmounts.find(a => a.amount === numAmount);
                            if (preset) {
                                this.selectedAmount = numAmount;
                            } else {
                                this.customAmount = numAmount.toString();
                                this.customAmountActive = true;
                            }
                        }
                    }
                }
            },
            mounted() {
                this.initFromUrl();

                // Load last preferences
                if (window.donationPrefs) {
                    const prefs = window.donationPrefs.load();
                    if (prefs.lastProject && !this.selectedProject) {
                        this.selectedProject = prefs.lastProject;
                    }
                }
            }
        }).mount('#app');
    </script>

    <style>
        /* Additional styles for donate page */
        .form-group {
            position: relative;
        }

        input[type="checkbox"],
        input[type="radio"] {
            accent-color: var(--accent-gold);
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        textarea.form-input {
            min-height: 100px;
        }

        /* Checkbox and radio custom styling */
        input[type="checkbox"]:checked,
        input[type="radio"]:checked {
            background-color: var(--accent-gold);
            border-color: var(--accent-gold);
        }

        /* Focus visible for accessibility */
        .payment-option:focus-visible,
        .amount-btn:focus-visible,
        button:focus-visible {
            outline: 2px solid var(--accent-gold);
            outline-offset: 2px;
        }

        /* Smooth step transitions */
        section[v-show] {
            animation: fadeInUp 0.4s ease-out;
        }
    </style>
</body>
</html>
